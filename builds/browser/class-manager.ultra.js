!function(e){var n,f=/^[a-zA-Z\_\$][a-zA-Z0-9\_\$]*$/,o=["Extends","Implements","Class","Shared","Merged","Prepare"],b={0:0,1:0,2:0,9:1,4:2,7:3},i=[2,0,1,9,10],r={"[object Boolean]":0,"[object Number]":1,"[object String]":2,"[object Function]":3,"[object Array]":4,"[object Date]":5,"[object RegExp]":6,"[object Object]":7,"[object Error]":8,"[object Null]":9,"[object Undefined]":10},t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a=0;function g(e,r){for(var n in r)e[n]=r[n]}function _(e){var r={};return g(r,e),r}function c(e,n,r,t,s){var a,c=n[0];if("number"==typeof c)if(r&&r[c])c=(c=r[c]).replace(/\{(\d+)\}/g,function(e,r){return n[+r]});else{a=[];for(var o=0,i=n.length;o<i;o++)a.push(encodeURIComponent(n[o]+""));c=t+"#v="+e+"&x="+a.join(",")}throw Error((s||"")+(c||"Debug assertion failed"))}function l(e){c("2.0.0",Array.prototype.slice.call(arguments),null,"https://_todo_/error_decoder.html","[ClassManager error] ")}function u(e){var r=t.test(e)?'"'+e.replace(t,function(e){var r=s[e];return"string"==typeof r?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"';return r}function k(e){return r[r.toString.call(e)]}function d(e){for(var r,n=[],t=0,s=e.length;t<s;t++){switch(k(e[t])){case 2:r=u(e[t]);break;case 9:case 10:case 0:case 1:r=e[t]+"";break;default:l()}n.push(r)}return"["+n.join(", ")+"]"}function v(e,r,n){var t,s,a,c={};for(t in r)if(!n||!(~o.indexOf(t)||t in e.Shared)){switch(k(s=r[t])){case 9:case 0:case 1:a={t:1,v:s};break;case 2:a={t:3,v:s};break;case 3:a={t:0,i:e.references.length},e.references.push(s);break;case 6:a={t:4,i:e.references.length},e.references.push(s);break;case 7:a={t:2,skeleton:v(e,s,!1)};break;case 4:0==s.length?a={t:5}:!function(e){var r=0,n=e.length,t=!0;if(10<n)t=!1;else for(;r<n;r++)if(!~i.indexOf(k(e[r]))){t=!1;break}return t}(s)?(a={t:7,i:e.references.length},e.references.push(s)):a={t:6,v:s}}c[t]=a}return c}function y(e){var r,n,t,s,a,c={},o=e.skeleton,i=[],l=!1;for(n in o){switch(o[n].t){case 3:r=u(o[n].v);break;case 1:r=o[n].v+"";break;case 5:r="[]";break;case 6:r=d(o[n].v);break;case 4:case 0:c[n]=e.references[o[n].i];break;case 7:r="r["+o[n].i+"].slice()",l=!0;break;case 2:a=[],function e(r,n,t,s){var a,c,o,i=!1;for(a in r){switch(r[a].t){case 3:c=u(r[a].v);break;case 1:c=r[a].v+"";break;case 4:case 0:c="r["+r[a].i+"]",i=!0;break;case 5:c="[]";break;case 6:c=d(r[a].v);break;case 7:c="r["+r[a].i+"].slice()",i=!0;break;case 2:o=[],e(r[a].skeleton,n,t+"\t",o)&&(i=!0),c=o.length?"{\n\t"+t+o.join(",\n\t"+t)+"\n"+t+"}":"{}"}f.test(a)?s.push('"'+a+'": '+c):s.push(u(a)+": "+c)}return i}(o[n].skeleton,e,"\t",a)&&(l=!0),r=a.length?"{\n\t"+a.join(",\n\t")+"\n}":"{}"}r&&(f.test(n)?i.push("this."+n+" = "+r):i.push("this["+u(n)+"] = "+r),r=null)}return g(c,e.Shared),c.Class=e,t+=(l?"var r=this.Class.references;\n":"")+i.join(";\n")+";",e.skeleton.init&&(t+="\nthis.init.apply(this, arguments);"),e.skeleton._afterInit&&(t+="\nthis._afterInit();"),g((s=Function(t)).prototype,c),s}function m(e,r,n,t,s,a){var c,o,i;for(o in t)if(i=(c=t[o]).t,o in r)if(0,0==i){if(!s||void 0!==a)continue;r[n.name+"$"+o]=c}else 2==i&&m(e,r[o].skeleton,n,c.skeleton,!1,a);else 2==i?(r[o]={t:2,skeleton:{}},m(e,r[o].skeleton,n,c.skeleton,!1,a)):r[o]=!a||0!=i&&7!=i&&4!=i?c:{t:i,i:c.i+a}}function S(e,r){this.name=e,this.class_body=r,this.parent_cdata=null,this.includes_names=[e],this.includes_cdata=[],this.skeleton=null,this.references=[],this.Shared={},this.Merged=[],this.is_abstract=!1,this.body_processors=null,this.class_manager=n,this.uid=a++}n={SAFE_PROPERTY_NAME_REGEX:f,quote:u,define:function(e,r){var n,t,s,a,c,o,i,l,f,u,d,h,p=new S(e,r);if("Class"in r&&(r.Class.is_abstract&&(p.is_abstract=!0)),"Prepare"in r&&(p.body_processors=[r.Prepare],r.Prepare()),"Extends"in r){if(t=r.Extends.prototype.Class,p.parent_cdata=t,p.includes_names=t.includes_names.concat(e),p.includes_cdata=t.includes_cdata.concat(t),p.references=t.references.slice(),p.Merged=t.Merged.slice(),t.body_processors){for(s=t.body_processors.length-1;0<=s;s--)t.body_processors[s].call(r);p.body_processors=t.body_processors.concat(p.body_processors)}for(n in t.Shared)o=b[k(t.Shared[n])],n in r?(i=b[k(r[n])],1==o?p.Shared[n]=r[n]:3==i?(p.Shared[n]=_(t.Shared[n]),g(p.Shared[n],r[n])):p.Shared[n]=~p.Merged.indexOf(n)?t.Shared[n].concat(r[n]):r[n]):p.Shared[n]=t.Shared[n]}if("Shared"in r||"Merged"in r){c="Shared"in r?r.Shared.slice():[],"Merged"in r&&(p.Merged=p.Merged.concat(r.Merged),function(e,r){for(var n=0,t=r.length;n<t;n++)~e.indexOf(r[n])||e.push(r[n])}(c,r.Merged));for(s=0,a=c.length;s<a;s++)k(r[n=c[s]]),p.Shared[n]=r[n]}if(p.skeleton=v(p,r,!0),t&&m(p,p.skeleton,t,t.skeleton,!0),"Implements"in r)for(s=0,a=(l=r.Implements).length;s<a;s++)u=p,d=l[s].prototype.Class,u.includes_names.push(d.name),u.includes_cdata=u.includes_cdata.concat(d,d.includes_cdata),h=u.references.length,u.references=u.references.concat(d.references),m(u,u.skeleton,d,d.skeleton,!0,h);return p.is_abstract?(f=function(){throw Error("Trying to create an instance of abstract class: "+p.name)}).prototype.Class=p:f=y(p),f},instanceOf:function(e,r){var n,t=!1,s=r.prototype.Class;return e&&(t=(n=e.Class)&&!e.hasOwnProperty("Class")&&(n==s||!!~n.includes_cdata.indexOf(s))),t},isValidClass:function(e){return"function"==typeof e&&e.prototype.Class&&e.prototype.Class.class_manager==n},_t:c,e:g,c:_},"undefined"!=typeof module&&module.exports?module.exports=n:e.ClassManager=n}(this);