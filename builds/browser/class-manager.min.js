!function(e){var n,b=/^[a-zA-Z\_][a-zA-Z0-9\_]*$/,f=/^[a-zA-Z\_\$][a-zA-Z0-9\_\$]*$/,c=["Extends","Implements","Class","Shared","Merged","Prepare"],_={0:0,1:0,2:0,9:1,4:2,7:3},l=[2,0,1,9,10],r={"[object Boolean]":0,"[object Number]":1,"[object String]":2,"[object Function]":3,"[object Array]":4,"[object Date]":5,"[object RegExp]":6,"[object Object]":7,"[object Error]":8,"[object Null]":9,"[object Undefined]":10},t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a=0;function k(e,r){for(var n in r)e[n]=r[n]}function g(e){var r={};return k(r,e),r}function i(e,n,r,t,s){var a,i=n[0];if("number"==typeof i)if(r&&r[i])i=(i=r[i]).replace(/\{(\d+)\}/g,function(e,r){return n[+r]});else{a=[];for(var o=0,c=n.length;o<c;o++)a.push(encodeURIComponent(n[o]+""));i=t+"#v="+e+"&x="+a.join(",")}throw Error((s||"")+(i||"Debug assertion failed"))}function m(e){i("2.0.0",Array.prototype.slice.call(arguments),null,"https://_todo_/error_decoder.html","[ClassManager error] ")}function d(e){var r=t.test(e)?'"'+e.replace(t,function(e){var r=s[e];return"string"==typeof r?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"';return r}function y(e){return r[r.toString.call(e)]}function u(e){for(var r,n=[],t=0,s=e.length;t<s;t++){switch(y(e[t])){case 2:r=d(e[t]);break;case 9:case 10:case 0:case 1:r=e[t]+"";break;default:m()}n.push(r)}return"["+n.join(", ")+"]"}function v(e,r,n){var t,s,a,i,o={};for(t in r)if(!n||!(~c.indexOf(t)||t in e.Shared)){switch(a=y(s=r[t])){case 9:case 0:case 1:i={t:1,v:s};break;case 2:i={t:3,v:s};break;case 3:i={t:0,i:e.references.length},e.references.push(s);break;case 6:i={t:4,i:e.references.length},e.references.push(s);break;case 7:i={t:2,skeleton:v(e,s,!1)};break;case 4:0==s.length?i={t:5}:!function(e){var r=0,n=e.length,t=!0;if(10<n)t=!1;else for(;r<n;r++)if(!~l.indexOf(y(e[r]))){t=!1;break}return t}(s)?(i={t:7,i:e.references.length},e.references.push(s)):i={t:6,v:s};break;case 10:m(13,t);break;default:m(14,a)}o[t]=i}return o}function S(e){var r,n,t,s,a,i={},o=e.skeleton,c=[],l=!1;for(n in o){switch(o[n].t){case 3:r=d(o[n].v);break;case 1:r=o[n].v+"";break;case 5:r="[]";break;case 6:r=u(o[n].v);break;case 4:case 0:i[n]=e.references[o[n].i];break;case 7:r="r["+o[n].i+"].slice()",l=!0;break;case 2:a=[],function e(r,n,t,s){var a,i,o,c=!1;for(a in r){switch(r[a].t){case 3:i=d(r[a].v);break;case 1:i=r[a].v+"";break;case 4:case 0:i="r["+r[a].i+"]",c=!0;break;case 5:i="[]";break;case 6:i=u(r[a].v);break;case 7:i="r["+r[a].i+"].slice()",c=!0;break;case 2:o=[],e(r[a].skeleton,n,t+"\t",o)&&(c=!0),i=o.length?"{\n\t"+t+o.join(",\n\t"+t)+"\n"+t+"}":"{}";break;default:m()}f.test(a)?s.push('"'+a+'": '+i):s.push(d(a)+": "+i)}return c}(o[n].skeleton,e,"\t",a)&&(l=!0),r=a.length?"{\n\t"+a.join(",\n\t")+"\n}":"{}";break;default:m()}r&&(f.test(n)?c.push("this."+n+" = "+r):c.push("this["+d(n)+"] = "+r),r=null)}return k(i,e.Shared),i.Class=e,t='if (!this.Class) throw new Error("Class constructor was called without `new` operator.");',t+=(l?"var r=this.Class.references;\n":"")+c.join(";\n")+";",e.skeleton.init&&(t+="\nthis.init.apply(this, arguments);"),e.skeleton._afterInit&&(0!=e.skeleton._afterInit.t&&m(24),t+="\nthis._afterInit();"),k((s=Function(t)).prototype,i),s}function C(e,r,n,t,s,a){var i,o,c,l;for(o in t)if(l=(i=t[o]).t,o in r)if(s&&0==r[o].t^0==l&&(0==r[o].t&&1==l&&null==i.v||m(11,e.name,o)),0==l){if(!s||void 0!==a)continue;(c=n.name+"$"+o)in r&&m(12,c),r[c]=i}else 2==l&&C(e,r[o].skeleton,n,i.skeleton,!1,a);else 2==l?(r[o]={t:2,skeleton:{}},C(e,r[o].skeleton,n,i.skeleton,!1,a)):r[o]=!a||0!=l&&7!=l&&4!=l?i:{t:l,i:i.i+a}}function x(e,r){this.name=e,this.class_body=r,this.parent_cdata=null,this.includes_names=[e],this.includes_cdata=[],this.skeleton=null,this.references=[],this.Shared={},this.Merged=[],this.is_abstract=!1,this.body_processors=null,this.class_manager=n,this.uid=a++}n={SAFE_PROPERTY_NAME_REGEX:f,quote:d,define:function(e,r){b.test(e)||m(27,e);var n,t,s,a,i,o,c,l,f,d,u,h,p=new x(e,r);if("Class"in r&&((h=r.Class)||m(9,"Class"),h.is_abstract&&(p.is_abstract=!0)),"Prepare"in r&&("function"!=typeof r.Prepare&&m(9,"Prepare"),p.body_processors=[r.Prepare],r.Prepare()),"Extends"in r){if(f=r.Extends,this.isValidClass(f)||m(9,"Extends"),t=f.prototype.Class,~(p.parent_cdata=t).includes_names.indexOf(e)&&m(5,e),p.includes_names=t.includes_names.concat(e),p.includes_cdata=t.includes_cdata.concat(t),p.references=t.references.slice(),p.Merged=t.Merged.slice(),t.body_processors){for(s=t.body_processors.length-1;0<=s;s--)t.body_processors[s].call(r);p.body_processors=t.body_processors.concat(p.body_processors)}for(n in t.Shared)c=_[y(t.Shared[n])],n in r?(l=_[y(r[n])],1!=c&&(c==l||0==c&&1==l||m(8)),1==c?p.Shared[n]=r[n]:3==l?(p.Shared[n]=g(t.Shared[n]),k(p.Shared[n],r[n])):p.Shared[n]=~p.Merged.indexOf(n)?t.Shared[n].concat(r[n]):r[n]):p.Shared[n]=t.Shared[n]}if("Shared"in r||"Merged"in r){if(i="Shared"in r?(Array.isArray(r.Shared)||m(9,"Shared"),r.Shared.slice()):[],"Merged"in r){for(1,Array.isArray(r.Merged)||m(9,"Merged"),s=0,a=r.Merged.length;s<a;s++)4!=y(r[n=r.Merged[s]])&&m(7,n);p.Merged=p.Merged.concat(r.Merged),function(e,r){for(var n=0,t=r.length;n<t;n++)~e.indexOf(r[n])||e.push(r[n])}(i,r.Merged)}for(s=0,a=i.length;s<a;s++)o=y(r[n=i[s]]),n in r||m(17,n),o in _||m(18,n),p.parent_cdata&&n in p.parent_cdata.skeleton&&m(19,n),n in p.Shared&&m(20,e,n),p.Shared[n]=r[n]}if(p.skeleton=v(p,r,!0),t&&C(p,p.skeleton,t,t.skeleton,!0),"Implements"in r)for(d=r.Implements,Array.isArray(d)||m(9,"Implements"),s=0,a=d.length;s<a;s++)this.isValidClass(d[s])||m(28,s),function(e,r){var n,t;for(n in 1,r.Shared)m(22,r.name);~e.includes_names.indexOf(r.name)&&m(23,r.name),r.skeleton._afterInit&&m(10,r.name),e.includes_names.push(r.name),e.includes_cdata=e.includes_cdata.concat(r,r.includes_cdata),t=e.references.length,e.references=e.references.concat(r.references),C(e,e.skeleton,r,r.skeleton,!0,t)}(p,d[s].prototype.Class);for(n in 1,p.Shared)n in p.skeleton&&m(21,p.name,n);return p.is_abstract?(u=function(){throw Error("Trying to create an instance of abstract class: "+p.name)}).prototype.Class=p:u=S(p),u},instanceOf:function(e,r){this.isValidClass(r)||m();var n,t=!1,s=r.prototype.Class;return e&&(t=(n=e.Class)&&!e.hasOwnProperty("Class")&&(n==s||!!~n.includes_cdata.indexOf(s))),t},isValidClass:function(e){return"function"==typeof e&&e.prototype.Class&&e.prototype.Class.class_manager==n},_t:i,e:k,c:g},"undefined"!=typeof module&&module.exports?module.exports=n:e.ClassManager=n}(this);